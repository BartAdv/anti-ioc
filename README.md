The basic idea follows what's described here: http://www.haskellforall.com/2012/06/you-could-have-invented-free-monads.html
